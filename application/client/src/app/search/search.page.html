<ion-header>
  <ion-toolbar>
    <ion-title>
      <ion-img class="ion-margin-vertical logo" src="assets/icon/Oricon.png"></ion-img>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="onLogout()">
        <ion-label>Logout</ion-label>
        <ion-icon name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content color="dark">
  <div id="container">
    <input #fileinput type="file" accept="image/*;capture=camera" hidden (change)="handleFile($event.target.files)">
    <div class="flex-container" *ngIf="loadedProduct === ''">
      <ion-tab-button (click)="captureImage()">
        <ion-icon name="qr-code"></ion-icon>
        Upload QRCode
      </ion-tab-button>
      <ion-tab-button (click)="startScan()">
        <ion-icon name="scan-outline"></ion-icon>
        Start scan
      </ion-tab-button>
    </div>

    <!-- Shows our camera stream -->
    <video class="ion-margin-top" #video [hidden]="!scanActive" width="100%"></video>
    <!-- Used to render the camera stream images -->
    <canvas #canvas hidden></canvas>

    <!-- Stop our scanner preview if active -->
    <ion-button expand="full" (click)="stopScan()" color="danger" *ngIf="scanActive">
      <ion-icon slot="start" name="close"></ion-icon>
      Stop scan
    </ion-button>

    <ion-card *ngIf="loadedProduct" color="medium">
      <div class="ion-text-center">
        <ion-img style="border-radius: 10px !important; overflow: hidden" [src]="loadedProduct?.productImageBase64" class="product-image"></ion-img>
      </div>
      <div class="ion-padding ion-text-left">
        <h4><strong>{{ loadedProduct?.productName }}</strong></h4>
        <ion-text style="color: var(--ion-color-warning-shade)"><strong>{{ loadedProduct?.productPrice | currency:'IDR':'symbol-narrow':'3.0' }}</strong></ion-text>
        <ion-text><p>{{ loadedProduct?.productDescription }}</p></ion-text>
        <ion-item style="margin-top: 20px" color="medium" lines="none">
          <ion-icon name="location-outline" color="tertiary" slot="start"></ion-icon>
          <ion-label color="tertiary">Made in {{ loadedProduct?.productOrigin }}</ion-label>
        </ion-item>
        <ion-item color="medium" lines="none">
          <ion-icon name="calendar-outline" color="tertiary" slot="start"></ion-icon>
          <ion-text color="tertiary"><p>Released on</p></ion-text>
          <ion-label color="tertiary">
            <p><ion-datetime class="ion-no-padding" style="margin-left: 5px;" displayFormat="DD MMMM YYYY" [value]="loadedProduct?.productReleaseDate" readonly></ion-datetime></p>
          </ion-label>
        </ion-item>
      </div>
    </ion-card>

    <ion-button expand="block" (click)="reset()" color="warning" *ngIf="scanResult" class="ion-margin-top">
      <ion-icon slot="start" name="refresh"></ion-icon>
      Scan Again
    </ion-button>
  </div>

</ion-content>
